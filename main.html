<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>ç©¿å±±ç”²å°ˆè»Šé ç´„</title>
<style>
body { font-family: system-ui, sans-serif; background:#f5f6f7; margin:0; padding:0; }
header { background:#3c8050; color:#fff; text-align:center; padding:15px; font-size:22px; font-weight:bold; }
.card { background:#fff; margin:16px; border-radius:8px; padding:16px; box-shadow:0 0 5px rgba(0,0,0,0.1); }

/* çµ±ä¸€è¼¸å…¥å€ */
input, select { width:100%; padding:10px; margin-top:8px; border-radius:6px; border:1px solid #ccc; font-size:16px; }
button { width:100%; background:#3c8050; color:#fff; border:none; padding:12px; border-radius:6px; font-size:18px; font-weight:bold; margin-top:12px; cursor:pointer; position: relative; }
button:disabled { background:#aaa; cursor:not-allowed; }
button.loading { background:#2d6140; color: transparent; }
button.loading::after {
  content: ''; position: absolute; width: 20px; height: 20px; top: 50%; left: 50%;
  margin: -10px 0 0 -10px; border: 2px solid #ffffff; border-radius: 50%;
  border-top-color: transparent; animation: spin 1s linear infinite;
}
@keyframes spin { to { transform: rotate(360deg); } }

/* æç¤ºè¨Šæ¯ */
.notice { padding:10px; margin-top:10px; border-radius:6px; }
.notice.error { background:#fdecea; color:#b71c1c; border:1px solid #f5c2c7; }
.notice.success { background:#e8f5e9; color:#2e7d32; border:1px solid #81c784; }
.notice.holiday { background:#f9f9f9; color:#b71c1c; border:1px dashed #e57373; }

/* æ¨™ç±¤ */
label { display: block; margin-bottom: 8px; font-weight: bold; color: #333; }

/* æœˆæ›† */
.calendar { display: grid; grid-template-columns: repeat(7, 1fr); gap:6px; text-align:center; }
.calendar div { padding:8px 0; border-radius:6px; background:#fff; border:1px solid #ccc; cursor:pointer; }
.calendar div:hover { background:#e8f5e9; }
.calendar .holiday { background:#fdecea; color:#b71c1c; cursor:not-allowed; }
.calendar .selected { background:#3c8050; color:#fff; font-weight:bold; }

/* ç­æ¬¡æŒ‰éˆ• */
#routeButtons { display:flex; flex-wrap:wrap; gap:8px; justify-content:space-between; }
.route-btn {
  flex:0 0 calc(50% - 8px); padding:10px; border-radius:8px; text-align:center;
  border:1px solid; font-size:15px; cursor:pointer; transition:0.2s;
}
.route-btn.A1, .route-btn.B1 { background:#e8f5e9; color:#2e7d32; border-color:#4caf50; }
.route-btn.A2, .route-btn.B2 { background:#e8f0fe; color:#1a73e8; border-color:#4285f4; }
.route-btn.full { background:#eee; color:#999; border-color:#ccc; cursor:not-allowed; }
.route-btn.selected.A1, .route-btn.selected.B1 { background:#2e7d32; color:#fff; }
.route-btn.selected.A2, .route-btn.selected.B2 { background:#1a73e8; color:#fff; }

@media (max-width:480px){
  .route-btn{flex:0 0 calc(50% - 6px);min-height:65px;padding:8px 4px;}
}
</style>
</head>
<body>
<header>ğŸšŒ ç©¿å±±ç”²å°ˆè»Šé ç´„</header>

<div class="card">
  <div id="userInfo" style="margin-bottom:15px;line-height:1.5;color:#2e7d32;font-weight:bold;">
    ğŸ‘¤ ç‹å­é½Š bit.ly/éŠæˆ²é”äºº<br>ğŸ« é›»æ©Ÿå·¥ç¨‹å­¸ç³»ï½œ114230145
  </div>

  <!-- æ—¥æœŸé¸æ“‡ -->
  <label><center>é¸æ“‡æ­ä¹˜æ—¥æœŸ</center></label>
  <button onclick="toggleCalendar()">ğŸ“… æ‰“é–‹æœˆæ›†</button>
  <div id="calendarContainer" style="display:none;margin-top:10px;">
    <div id="calendar" class="calendar"></div>
  </div>
  <div id="selectedDate" class="notice success" style="display:none;"></div>
  <div id="holidayNotice" class="notice" style="display:none;"></div>

  <!-- ç­æ¬¡ -->
  <label>è«‹é¸æ“‡æ­ä¹˜ç­æ¬¡ *</label>
  <div id="routeButtons"></div>

  <!-- ä¸‹è»Šç«™ -->
  <label>ä¸‹è»Šç«™ *</label>
  <select id="toStop"><option value="">è«‹å…ˆé¸æ“‡ç­æ¬¡</option></select>

  <button id="submitBtn" onclick="submitForm()">é€å‡ºé ç´„</button>
  <div id="result"></div>
</div>

<script>
let selectedDate = null;
let selectedRoute = null;

// æ¨¡æ“¬ä½¿ç”¨è€…è³‡æ–™
const userData = { name: "ç‹å­é½Š bit.ly/éŠæˆ²é”äºº", phone: "0912345678", dept: "é›»æ©Ÿå·¥ç¨‹å­¸ç³»", schoolId: "114230145" };

// åœé ç«™ï¼ˆæ­£å‘/è¿”ç¨‹ï¼‰
const stopsOutbound = ["è¡Œæ”¿å¤§æ¨“","ä¸­é¤å»³","ç§‘æŠ€å­¸é™¢","å­¸äººæœƒé¤¨","ä¸­åŸ","ä¸‹åŸ","åªé ‚","æ„›è˜­æ©‹","å¤§æˆåœ‹å°","ä¸­å±±å®‰ä¸ƒè¡—å£","æ¦®æ°‘è¨ºæ‰€","åŸ”é‡Œé…’å» ","åŸ”é‡Œç¸½ç«™"];
const stopsReturn = ["åŸ”é‡Œç¸½ç«™","åŸ”é‡Œé…’å» ","æ¦®æ°‘è¨ºæ‰€","ä¸­å±±å®‰ä¸ƒè¡—å£","å¤§æˆåœ‹å°","æ„›è˜­æ©‹","åªé ‚","ä¸‹åŸ","ä¸­åŸ","å­¸äººæœƒé¤¨","ç§‘æŠ€å­¸é™¢","ä¸­é¤å»³","è¡Œæ”¿å¤§æ¨“"];

// === æœˆæ›† ===
function toggleCalendar(){
  const c = document.getElementById('calendarContainer');
  c.style.display = c.style.display === 'none' ? 'block' : 'none';
  if (c.style.display === 'block') renderCalendar();
}

function renderCalendar(){
  const cal = document.getElementById('calendar');
  cal.innerHTML = "";
  const today = new Date();
  const year = today.getFullYear();
  const month = today.getMonth();
  const firstDay = new Date(year, month, 1);
  const totalDays = new Date(year, month+1, 0).getDate();
  const startWeekday = firstDay.getDay();
  const holidays = ['2025-10-12','2025-10-13']; // æ¨¡æ“¬å…¬ä¼‘

  for (let i=0;i<startWeekday;i++){ cal.appendChild(document.createElement('div')); }
  for (let d=1;d<=totalDays;d++){
    const date = new Date(year, month, d);
    const formatted = date.toISOString().split('T')[0];
    const cell = document.createElement('div');
    cell.textContent = d;
    if (holidays.includes(formatted) || date.getDay() === 0){
      cell.classList.add('holiday');
    } else {
      cell.onclick = ()=>selectDate(formatted);
    }
    cal.appendChild(cell);
  }
}

function selectDate(date){
  selectedDate = date;
  document.getElementById('calendarContainer').style.display='none';
  const holidayNotice=document.getElementById('holidayNotice');
  const sel=document.getElementById('selectedDate');
  const holidays=['2025-10-12','2025-10-13'];
  if(holidays.includes(date)){
    holidayNotice.innerHTML='ğŸš« æœ¬æ—¥ç‚ºåœé§›/å…¬ä¼‘ï¼Œç„¡æ³•é ç´„';
    holidayNotice.style.display='block';
    sel.style.display='none';
    document.getElementById('routeButtons').innerHTML='';
    return;
  }
  holidayNotice.style.display='none';
  sel.innerHTML='âœ… å·²é¸æ“‡æ—¥æœŸï¼š'+date;
  sel.style.display='block';
  loadSeatStatus(date);
}

// === è¼‰å…¥ç­æ¬¡ç‹€æ³ ===
function loadSeatStatus(date){
  const container=document.getElementById('routeButtons');
  container.innerHTML='';
  const routeData={
    A1:{name:'A1 æš¨å¤§â†’åŸ”é‡Œç¸½ç«™',remain:3,full:false},
    A2:{name:'A2 æš¨å¤§â†’åŸ”é‡Œç¸½ç«™',remain:0,full:true},
    B1:{name:'B1 åŸ”é‡Œç¸½ç«™â†’æš¨å¤§',remain:2,full:false},
    B2:{name:'B2 åŸ”é‡Œç¸½ç«™â†’æš¨å¤§',remain:5,full:false}
  };
  ['A1','A2','B1','B2'].forEach(rid=>{
    const r=routeData[rid];
    const div=document.createElement('div');
    div.className=`route-btn ${rid}`;
    if(r.full) div.classList.add('full');
    div.innerHTML=`<div><b>${r.name}</b><br>${r.full?'å·²æ»¿':r.remain+' ä½'}</div>`;
    if(!r.full) div.onclick=()=>selectRoute(div,rid,r.name);
    container.appendChild(div);
  });
}

// === é¸æ“‡ç­æ¬¡ ===
function selectRoute(btn,id,name){
  selectedRoute=id;
  document.querySelectorAll('.route-btn').forEach(b=>b.classList.remove('selected'));
  btn.classList.add('selected');
  updateStops(name);
}

// === ä¸‹è»Šç«™ ===
function updateStops(routeName){
  const toStop=document.getElementById('toStop');
  toStop.innerHTML='<option value="">è«‹é¸æ“‡ä¸‹è»Šç«™</option>';
  const isOutbound=routeName.includes('æš¨å¤§â†’åŸ”é‡Œ');
  const stops=isOutbound?stopsOutbound:stopsReturn;
  const fromStop=isOutbound?'è¡Œæ”¿å¤§æ¨“':'åŸ”é‡Œç¸½ç«™';
  stops.filter(s=>s!==fromStop).forEach(s=>{
    const o=document.createElement('option');
    o.value=s; o.textContent=s;
    toStop.appendChild(o);
  });
}

// === é ç´„ ===
function submitForm(){
  const toStop=document.getElementById('toStop').value;
  const btn=document.getElementById('submitBtn');
  if(!selectedDate||!selectedRoute||!toStop){
    alert('è«‹å®Œæ•´é¸æ“‡æ—¥æœŸã€ç­æ¬¡èˆ‡ä¸‹è»Šç«™');
    return;
  }
  btn.disabled=true; btn.classList.add('loading');
  setTimeout(()=>{
    btn.disabled=false; btn.classList.remove('loading');
    document.getElementById('result').innerHTML=
      `<div class="notice success">
        âœ… ${userData.name}<br>
        æ—¥æœŸï¼š${selectedDate}<br>
        ç­æ¬¡ï¼š${selectedRoute}<br>
        ä¸‹è»Šç«™ï¼š${toStop}<br>
        <b>é ç´„æˆåŠŸï¼</b>
      </div>`;
  },1000);
}
</script>
</body>
</html>
