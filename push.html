<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ç©¿å±±ç”²å°ˆè»Šæ¨æ’­å·¥å…·</title>
  <style>
    body { font-family: system-ui, sans-serif; background:#f5f6f7; margin:0; padding:20px; }
    h1 { text-align:center; color:#3c8050; }
    .card { background:#fff; border-radius:12px; box-shadow:0 2px 8px rgba(0,0,0,0.1); padding:20px; max-width:480px; margin:20px auto; }
    label { display:block; margin-top:10px; font-weight:bold; color:#333; }
    input, select { width:100%; padding:10px; border:1px solid #ccc; border-radius:6px; font-size:14px; margin-top:4px; }
    button { background:#3c8050; color:white; border:none; border-radius:8px; padding:12px 16px; font-size:16px; font-weight:bold; cursor:pointer; width:100%; margin-top:20px; }
    button:hover { background:#2d6140; }
    .result { margin-top:20px; text-align:center; font-weight:bold; }
  </style>
</head>
<body>
  <h1>ğŸšŒ ç©¿å±±ç”²å°ˆè»Šæ¨æ’­å·¥å…·</h1>

  <div class="card">
    <label>æ¨æ’­é¡å‹</label>
    <select id="pushType">
      <option value="reserve">æ–°é ç´„é€šçŸ¥</option>
      <option value="cancel">å–æ¶ˆé ç´„é€šçŸ¥</option>
    </select>

    <label>æ—¥æœŸ</label>
    <input id="date" type="date" />

    <label>ç­æ¬¡</label>
    <input id="route" placeholder="ä¾‹å¦‚ï¼šA1 | 22:00-22:30 æš¨å¤§â†’åŸ”é‡Œç¸½ç«™" />

    <label>å§“å</label>
    <input id="name" placeholder="ä½¿ç”¨è€…å§“å" />

    <label>é›»è©±</label>
    <input id="phone" placeholder="é›»è©±è™Ÿç¢¼" />

    <label>ä¸Šè»Šç«™</label>
    <input id="fromStop" placeholder="ä¾‹å¦‚ï¼šè¡Œæ”¿å¤§æ¨“" />

    <label>ä¸‹è»Šç«™</label>
    <input id="toStop" placeholder="ä¾‹å¦‚ï¼šåŸ”é‡Œé…’å» " />

    <button onclick="sendPush()">ğŸš€ ç™¼é€æ¨æ’­</button>
    <div id="result" class="result"></div>
  </div>

<script>
const WORKER_URL = 'https://delicate-math-7e61.fangwl591021.workers.dev/';

async function sendPush(){
  const type = document.getElementById('pushType').value;
  const date = document.getElementById('date').value;
  const route = document.getElementById('route').value;
  const name = document.getElementById('name').value;
  const phone = document.getElementById('phone').value;
  const fromStop = document.getElementById('fromStop').value;
  const toStop = document.getElementById('toStop').value;
  const result = document.getElementById('result');

  if(!date || !route || !name){ result.textContent='âŒ å¿…å¡«æ¬„ä½æœªå®Œæˆ'; result.style.color='red'; return; }

  let color = type === 'cancel' ? '#D32F2F' : '#27ACB2';
  let title = type === 'cancel' ? '# ç©¿å±±ç”²å°ˆè»Šé ç´„å–æ¶ˆ' : '# ç©¿å±±ç”²å°ˆè»Šæ–°é ç´„';

  const flex = {
    type: 'flex',
    altText: title,
    contents: {
      type: 'bubble',
      size: 'mega',
      header: {
        type: 'box',
        layout: 'vertical',
        contents: [{
          type: 'text', 
          text: title, 
          weight: 'bold', 
          color: '#fff', 
          align: 'start',
          size: 'lg'
        }],
        backgroundColor: color
      },
      body: {
        type: 'box',
        layout: 'vertical',
        spacing: 'md',
        contents: [
          { type: 'text', text: `æ—¥æœŸï¼š${date}`, size: 'md', wrap: true },
          { type: 'text', text: `å§“åï¼š${name}`, size: 'md', wrap: true },
          { type: 'text', text: `ç­æ¬¡ï¼š${route}`, size: 'md', wrap: true },
          { 
            type: 'text', 
            text: `ç‹€æ…‹ï¼š${type === 'cancel' ? 'å·²å–æ¶ˆ' : 'æ–°é ç´„'}`, 
            size: 'md', 
            wrap: true,
            weight: 'bold',
            color: type === 'cancel' ? '#D32F2F' : '#27ACB2'
          }
        ]
      }
    }
  };

  try {
    const res = await fetch(WORKER_URL, {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ type: 'pushLine', flex })
    });
    const text = await res.text();
    console.log(text);
    result.textContent = 'âœ… æ¨æ’­æˆåŠŸï¼';
    result.style.color = 'green';
  } catch (e) {
    console.error(e);
    result.textContent = 'âŒ æ¨æ’­å¤±æ•—';
    result.style.color = 'red';
  }
}
</script>
</body>
</html>
